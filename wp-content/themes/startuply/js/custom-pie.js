/* =========================================================
 * jquery.vc_chart.js v1.0
 * =========================================================
 * Copyright 2013 Wpbakery
 *
 * Jquery chart plugin for the Visual Composer(modified).
 * ========================================================= */
!function(i){var s=function(t,s){this.el=t,this.$el=i(this.el),this.options=i.extend({color:"",units:"",units_color:"",content_selector:".vsc_pie_chart_inside",number_selector:".vsc_pie_chart_value",icon_selector:".vsc_pie_chart_icon",heading_selector:".vsc_pie_wrapper .wpb_pie_chart_heading",back_selector:".vsc_pie_chart_back",responsive:!0},s),this.init()};s.prototype={constructor:s,_progress_v:0,animated:!1,i:1,init:function(){this.setupColor(),this.value=this.$el.data("pie-value")/100,this.label_value=this.$el.data("pie-label-value")||this.$el.data("pie-value"),this.$wrapper=i(".vsc_pie_wrapper",this.$el),this.$inside=i(this.options.content_selector,this.$el),this.$number=i(this.options.number_selector,this.$el),this.$icon=i(this.options.icon_selector,this.$el),this.$heading=i(this.options.heading_selector,this.$el),this.$back=i(this.options.back_selector,this.$el),this.$canvas=this.$el.find("canvas"),this.draw(),this.setWayPoint(),this.options.responsive===!0&&this.setResponsive()},setupColor:function(){"string"==typeof this.options.color&&this.options.color.match(/^rgba?\([^\)]+\)/)?this.color=this.options.color:this.color="rgba(26, 198, 255, 0.2)"},setResponsive:function(){var t=this;i(window).resize(function(){t.redraw()})},redraw:function(){this.animated===!0&&this.circle.stop(),this.draw(!0)},changeColor:function(t){redraw=!1,"object"==typeof t?(t.color&&(color=t.color),t.redraw&&(redraw=t.redraw)):"string"==typeof t&&(color=t),color&&(this.color=color),redraw&&this.redraw()},draw:function(t){var s,e=this.$el.addClass("vsc_ready").width(),r=parseInt(this.$el.attr("data-thickness"))-2;e||(e=this.$el.parents(":visible").first().width()-2),e=this.$wrapper.attr("data-radius").length&&parseInt(this.$wrapper.attr("data-radius"))<=e/2&&parseInt(this.$wrapper.attr("data-radius"))>0?2*parseInt(this.$wrapper.attr("data-radius")):e/100*80,r>=e/2-1&&(r=e/2-2),this.$el.find(".vsc_pie_chart_back").css("border-width",r),e>=500&&(e=500),s=e/2-r-1,this.$wrapper.css({width:e+"px"}),this.$inside.length||(this.$number.css({width:e,height:e,"line-height":e+"px"}),this.$icon.css({width:e,height:e,"line-height":e+"px"}),this.$icon.css("font-size",.25*(e-r)),this.$heading.css({width:e,height:e,"line-height":e+"px"})),this.$back.css({width:e,height:e}),this.$canvas.attr({width:e+"px",height:e+"px"}),this.$el.addClass("vsc_ready"),this.circle=new ProgressCircle({canvas:this.$canvas.get(0),minRadius:s+2,arcWidth:r-2}),t===!0&&this.animated===!0&&(this._progress_v=this.value,this.circle.addEntry({fillColor:this.color,progressListener:i.proxy(this.setProgress,this)}).start(10))},setProgress:function(){var i='<span style="color: '+this.options.units_color+';">'+this.options.units+"</span>";if(this._progress_v>=this.value)return this.circle.stop(),this.$number.html(this.label_value+i),this._progress_v;t=this.i/100,this.i++,this._progress_v+=this.value*(t/=5)*t,this.$el.hasClass("no-animation")&&(this._progress_v=this.value);var s=this._progress_v/this.value*this.label_value,e=Math.round(s).toString()+i;return this.$number.html(e),this._progress_v},animate:function(){this.animated!==!0&&(this.animated=!0,this.circle.addEntry({fillColor:this.color,progressListener:i.proxy(this.setProgress,this)}).start(10))},setWayPoint:function(){"undefined"!=typeof i.fn.waypoint?this.$el.waypoint(i.proxy(this.animate,this),{offset:"85%"}):this.animate()}},i.fn.vcChat=function(t,e){return this.each(function(){var r=i(this),o=r.data("vsc_chart"),a="object"==typeof t?t:{color:r.data("pie-color")||i(".back-to-top i").css("color"),units:r.data("pie-units"),units_color:r.data("pie-units-color")};"undefined"==typeof t&&r.data("vsc_chart",o=new s(this,a)),"string"==typeof t&&o&&"function"==typeof o[t]&&o[t](e)})},"function"!=typeof window.vc_pieChart&&(window.vc_pieChart=function(){i(".vsc_pie_chart:visible").vcChat()}),i(document).ready(function(){!window.vc_iframe&&vc_pieChart()})}(window.jQuery);
